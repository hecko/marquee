#!/usr/bin/perl

use FindBin;
use lib "$FindBin::Bin/../../lib";

use warnings;
use strict;
use JSON;
use Data::Dumper::Concise;
use Time::HiRes qw<gettimeofday>;
use Marquee::Runtime;

my %hash =(
    name => "test",
    severity => 23,
    when => time(),
    message => "this is a basic message",
    cmdb_ci => 241,
    source => "test_source",
    status => 1,
    description => "marquee is a new monitoring system, message from ".time(),
    contact_group => "tapaj",
);

$hash{uid} = Marquee::Runtime->get_next_uid;

my $json = JSON::XS->new->pretty(1)->indent(1)->encode(\%hash);

die "unable to open file handle" if !open my $fh, ">", "../../var/data/in/$hash{uid}.json";
print $json;
print $fh $json;
close($fh);
